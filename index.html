<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>StateOfRochester</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Source+Serif+4:ital,wght@0,300;0,400;0,600;1,400&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet"/>
  <style>
    :root {
      --ink: #0f0f0f;
      --paper: #f5f0e8;
      --paper-dark: #ece6d6;
      --red: #c0392b;
      --accent: #1a3a5c;
      --mid: #7f8c8d;
      --rule: #2c2c2c;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--paper);
      color: var(--ink);
      font-family: 'Source Serif 4', Georgia, serif;
      font-size: 16px;
      line-height: 1.6;
    }

    /* â”€â”€ MASTHEAD â”€â”€ */
    .masthead {
      background: var(--ink);
      color: var(--paper);
      text-align: center;
      padding: 2rem 1rem 1.4rem;
      border-bottom: 4px solid var(--red);
      position: relative;
      overflow: hidden;
    }
    .masthead::before {
      content: '';
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(255,255,255,0.015) 2px,
        rgba(255,255,255,0.015) 4px
      );
      pointer-events: none;
    }
    .masthead-eyebrow {
      font-family: 'DM Mono', monospace;
      font-size: 0.65rem;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      color: var(--mid);
      margin-bottom: 0.5rem;
    }
    .masthead h1 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(2.8rem, 8vw, 5.5rem);
      font-weight: 900;
      letter-spacing: -0.02em;
      line-height: 1;
      color: var(--paper);
    }
    .masthead h1 span {
      color: var(--red);
    }
    .masthead-tagline {
      font-family: 'Source Serif 4', serif;
      font-style: italic;
      font-size: 0.95rem;
      color: #a09080;
      margin-top: 0.6rem;
    }
    .masthead-meta {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-top: 1.2rem;
      padding-top: 1rem;
      border-top: 1px solid #333;
      font-family: 'DM Mono', monospace;
      font-size: 0.6rem;
      letter-spacing: 0.15em;
      color: #666;
      text-transform: uppercase;
    }

    /* â”€â”€ NAV â”€â”€ */
    nav {
      background: var(--paper-dark);
      border-bottom: 2px solid var(--ink);
      display: flex;
      justify-content: center;
      gap: 0;
    }
    nav a {
      display: block;
      padding: 0.65rem 1.2rem;
      font-family: 'DM Mono', monospace;
      font-size: 0.7rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      text-decoration: none;
      color: var(--ink);
      border-right: 1px solid #ccc;
      transition: background 0.15s;
    }
    nav a:first-child { border-left: 1px solid #ccc; }
    nav a:hover { background: var(--ink); color: var(--paper); }
    nav a.active { background: var(--accent); color: #fff; }

    /* â”€â”€ LAYOUT â”€â”€ */
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }

    /* â”€â”€ CRISIS METER â”€â”€ */
    .crisis-section {
      background: var(--ink);
      color: var(--paper);
      padding: 2rem 1.5rem 2.2rem;
      border-bottom: 3px solid var(--red);
    }
    .crisis-inner {
      max-width: 800px;
      margin: 0 auto;
    }
    .crisis-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      margin-bottom: 1.2rem;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    .crisis-title {
      font-family: 'DM Mono', monospace;
      font-size: 0.65rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: var(--mid);
    }
    .crisis-status-label {
      font-family: 'Playfair Display', serif;
      font-size: 1.4rem;
      font-weight: 700;
      color: #f0c040;
    }
    .crisis-updated {
      font-family: 'DM Mono', monospace;
      font-size: 0.6rem;
      color: #555;
      letter-spacing: 0.1em;
    }

    /* Gradient Bar */
    .meter-wrap {
      position: relative;
      padding-bottom: 2.2rem;
    }
    .meter-bar {
      width: 100%;
      height: 22px;
      border-radius: 3px;
      background: linear-gradient(to right,
        #c0392b 0%,
        #e67e22 25%,
        #f1c40f 50%,
        #a8d840 75%,
        #27ae60 100%
      );
      box-shadow: 0 0 18px rgba(241,196,15,0.15);
      position: relative;
    }

    /* Marker */
    .meter-marker {
      position: absolute;
      top: -6px;
      transform: translateX(-50%);
      width: 4px;
      height: 34px;
      background: #fff;
      border-radius: 2px;
      box-shadow: 0 0 8px rgba(255,255,255,0.8);
      /* Current level: 0% = critical, 100% = all clear. Set via style attr. */
    }
    .meter-marker::after {
      content: '';
      position: absolute;
      bottom: -6px;
      left: 50%;
      transform: translateX(-50%);
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-top: 6px solid #fff;
    }

    /* Labels */
    .meter-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 0.5rem;
      font-family: 'DM Mono', monospace;
      font-size: 0.58rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: #666;
    }

    .crisis-desc {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #b0a898;
      font-style: italic;
      line-height: 1.5;
      border-left: 3px solid #f1c40f;
      padding-left: 0.8rem;
    }

    /* â”€â”€ CONTENT GRID â”€â”€ */
    .content-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 0;
      border-bottom: 2px solid var(--ink);
    }

    .section-label {
      font-family: 'DM Mono', monospace;
      font-size: 0.6rem;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      color: var(--mid);
      margin-bottom: 0.8rem;
      padding-bottom: 0.4rem;
      border-bottom: 2px solid var(--ink);
    }

    /* HERO ARTICLE */
    .hero-col {
      grid-column: 1 / 3;
      padding: 2rem 2rem 2rem 0;
      border-right: 1px solid #ccc;
    }
    .hero-article .article-tag {
      display: inline-block;
      background: var(--red);
      color: #fff;
      font-family: 'DM Mono', monospace;
      font-size: 0.58rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      padding: 0.2rem 0.5rem;
      margin-bottom: 0.8rem;
    }
    .hero-article h2 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.6rem, 3vw, 2.3rem);
      font-weight: 900;
      line-height: 1.15;
      margin-bottom: 0.8rem;
      letter-spacing: -0.02em;
    }
    .hero-article h2 a {
      color: var(--ink);
      text-decoration: none;
    }
    .hero-article h2 a:hover { color: var(--accent); }
    .hero-article .byline {
      font-family: 'DM Mono', monospace;
      font-size: 0.62rem;
      color: var(--mid);
      letter-spacing: 0.08em;
      margin-bottom: 0.8rem;
    }
    .hero-article p {
      font-size: 1rem;
      color: #333;
      line-height: 1.7;
    }
    .hero-divider {
      width: 40px;
      height: 3px;
      background: var(--red);
      margin: 1rem 0;
    }

    /* SIDEBAR */
    .sidebar-col {
      padding: 2rem 0 2rem 1.8rem;
    }
    .sidebar-articles { display: flex; flex-direction: column; gap: 1.4rem; }
    .sidebar-article {
      padding-bottom: 1.4rem;
      border-bottom: 1px solid #ddd;
    }
    .sidebar-article:last-child { border-bottom: none; padding-bottom: 0; }
    .sidebar-article .article-tag {
      font-family: 'DM Mono', monospace;
      font-size: 0.55rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--accent);
      margin-bottom: 0.3rem;
    }
    .sidebar-article h3 {
      font-family: 'Playfair Display', serif;
      font-size: 1.05rem;
      font-weight: 700;
      line-height: 1.25;
      margin-bottom: 0.3rem;
    }
    .sidebar-article h3 a { color: var(--ink); text-decoration: none; }
    .sidebar-article h3 a:hover { color: var(--accent); }
    .sidebar-article .byline {
      font-family: 'DM Mono', monospace;
      font-size: 0.58rem;
      color: var(--mid);
    }

    /* â”€â”€ SECONDARY ROW â”€â”€ */
    .secondary-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0;
      border-bottom: 2px solid var(--ink);
      padding: 2rem 0;
    }
    .secondary-article {
      padding: 0 1.5rem;
      border-right: 1px solid #ccc;
    }
    .secondary-article:first-child { padding-left: 0; }
    .secondary-article:last-child { border-right: none; padding-right: 0; }
    .secondary-article .article-tag {
      font-family: 'DM Mono', monospace;
      font-size: 0.55rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--accent);
      margin-bottom: 0.4rem;
    }
    .secondary-article h3 {
      font-family: 'Playfair Display', serif;
      font-size: 1.05rem;
      font-weight: 700;
      line-height: 1.3;
      margin-bottom: 0.4rem;
    }
    .secondary-article h3 a { color: var(--ink); text-decoration: none; }
    .secondary-article h3 a:hover { color: var(--accent); }
    .secondary-article p {
      font-size: 0.85rem;
      color: #555;
      line-height: 1.6;
    }
    .secondary-article .byline {
      font-family: 'DM Mono', monospace;
      font-size: 0.58rem;
      color: var(--mid);
      margin-top: 0.5rem;
    }

    /* â”€â”€ FOOTER â”€â”€ */
    footer {
      background: var(--ink);
      color: #777;
      text-align: center;
      padding: 2rem 1rem;
      font-family: 'DM Mono', monospace;
      font-size: 0.62rem;
      letter-spacing: 0.1em;
    }
    footer a { color: #999; text-decoration: none; }
    footer a:hover { color: var(--paper); }
    footer .footer-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
      color: var(--paper);
      letter-spacing: -0.01em;
      margin-bottom: 0.5rem;
    }

    /* â”€â”€ TAB PANELS â”€â”€ */
    .tab-panel { display: none; }
    .tab-panel.active { display: block; }

    /* â”€â”€ TIPS PANEL â”€â”€ */
    .tips-panel {
      max-width: 820px;
      margin: 0 auto;
      padding: 3rem 1.5rem 4rem;
    }
    .tips-panel-header {
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 3px solid var(--ink);
    }
    .tips-panel-header .page-label {
      font-family: 'DM Mono', monospace;
      font-size: 0.62rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: var(--mid);
      margin-bottom: 0.8rem;
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }
    .tips-panel-header .page-label::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #ccc;
    }
    .tips-panel-header h2 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.8rem, 4vw, 2.6rem);
      font-weight: 900;
      letter-spacing: -0.02em;
      line-height: 1.1;
      margin-bottom: 0.6rem;
    }
    .tips-panel-header p {
      font-size: 1rem;
      color: #555;
      line-height: 1.7;
      max-width: 600px;
    }

    /* Tips form fields */
    .tip-form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }
    .tip-form-grid .field-full { grid-column: 1 / -1; }
    .tip-field {
      margin-bottom: 0;
    }
    .tip-field label {
      display: block;
      font-family: 'DM Mono', monospace;
      font-size: 0.6rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--mid);
      margin-bottom: 0.4rem;
    }
    .tip-field input,
    .tip-field textarea,
    .tip-field select {
      width: 100%;
      background: var(--paper-dark);
      border: 1px solid #ccc;
      border-bottom: 2px solid var(--ink);
      padding: 0.65rem 0.75rem;
      font-family: 'Source Serif 4', serif;
      font-size: 0.9rem;
      color: var(--ink);
      outline: none;
      transition: border-color 0.15s, background 0.15s;
      appearance: none;
      border-radius: 0;
    }
    .tip-field input:focus,
    .tip-field textarea:focus,
    .tip-field select:focus {
      border-color: var(--accent);
      background: #fff;
    }
    .tip-field textarea { resize: vertical; min-height: 130px; }
    .tip-submit {
      background: var(--red);
      color: #fff;
      border: none;
      padding: 0.85rem 2rem;
      font-family: 'DM Mono', monospace;
      font-size: 0.7rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      cursor: pointer;
      transition: background 0.15s;
      margin-top: 0.5rem;
    }
    .tip-submit:hover { background: #a93226; }
    .tip-privacy {
      margin-top: 0.7rem;
      font-family: 'DM Mono', monospace;
      font-size: 0.57rem;
      letter-spacing: 0.08em;
      color: var(--mid);
      line-height: 1.5;
    }

    /* â”€â”€ RANGE SLIDER THUMB (base â€” color set dynamically via JS) â”€â”€ */
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      background: transparent !important;
      border: none !important;
      padding: 0 !important;
      cursor: pointer;
    }
    input[type="range"]::-webkit-slider-runnable-track {
      height: 4px;
      background: #bbb;
      border-radius: 2px;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #f1c40f; /* default yellow â€” overridden by JS */
      border: 3px solid #fff;
      box-shadow: 0 0 0 2px #f1c40f;
      margin-top: -8px;
      cursor: pointer;
      transition: transform 0.1s;
    }
    input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.15); }
    input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #f1c40f;
      border: 3px solid #fff;
      box-shadow: 0 0 0 2px #f1c40f;
      cursor: pointer;
    }
    input[type="range"]::-moz-range-track {
      height: 4px;
      background: #bbb;
      border-radius: 2px;
    }

    @media (max-width: 600px) {
      .tip-form-grid { grid-template-columns: 1fr; }
      .tip-form-grid .field-full { grid-column: 1; }
    }

    /* â”€â”€ ANIMATIONS â”€â”€ */
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(16px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .masthead h1, .crisis-section, .hero-article, .sidebar-col {
      animation: fadeUp 0.6s ease both;
    }
    .masthead h1        { animation-delay: 0.05s; }
    .crisis-section     { animation-delay: 0.15s; }
    .hero-article       { animation-delay: 0.25s; }
    .sidebar-col        { animation-delay: 0.35s; }

    @media (max-width: 700px) {
      .content-grid { grid-template-columns: 1fr; }
      .hero-col { grid-column: 1; border-right: none; padding: 1.5rem 0; }
      .sidebar-col { padding: 0 0 1.5rem; border-top: 2px solid var(--ink); }
      .secondary-row { grid-template-columns: 1fr; gap: 1.5rem; }
      .secondary-article { border-right: none; padding: 0; border-bottom: 1px solid #ccc; padding-bottom: 1.5rem; }
      nav { flex-wrap: wrap; justify-content: flex-start; }
    }
  </style>
</head>
<body>

<!-- MASTHEAD -->
<header class="masthead">
  <div class="masthead-eyebrow">Rochester, New York Â· Est. 2025</div>
  <h1>State<span>Of</span>Rochester</h1>
  <p class="masthead-tagline">The community pulse of the Flower City</p>
  <div class="masthead-meta">
    <span id="todays-date"></span>
    <span>Rochester, NY</span>
    <span>Independent &amp; Local</span>
  </div>
</header>

<!-- NAV -->
<nav>
  <a href="#" class="active" onclick="showTab('home', this); return false;">Home</a>
  <a href="safety.html">Safety</a>
  <a href="schools.html">Schools</a>
  <a href="neighborhoods.html">Neighborhoods</a>
  <a href="events.html">Events</a>
  <a href="about.html">About</a>
  <a href="#" id="tips-tab" onclick="showTab('tips', this); return false;">Tips</a>
</nav>

<!-- CRISIS METER -->
<section class="crisis-section">
  <div class="crisis-inner">
    <div class="crisis-header">
      <span class="crisis-title">Community Crisis Meter</span>
      <span class="crisis-status-label" id="crisis-label">Elevated Concern</span>
      <span class="crisis-updated" id="crisis-updated"></span>
    </div>
    <div class="meter-wrap">
      <div class="meter-bar">
        <!-- Marker position: left % = 0 (critical) to 100 (all clear). Currently ~38% = elevated -->
        <div class="meter-marker" id="meter-marker" style="left: 38%;"></div>
      </div>
      <div class="meter-labels">
        <span>ðŸ”´ Critical</span>
        <span>High</span>
        <span>Moderate</span>
        <span>Stable</span>
        <span>All Clear ðŸŸ¢</span>
      </div>
    </div>
    <p class="crisis-desc" id="crisis-desc">
      Multiple ongoing concerns: increased reports of property crime in the South Wedge, continued 
      road closures on Rt. 104, and city budget negotiations entering a critical phase. 
      Residents are advised to stay informed.
    </p>
  </div>
</section>

<!-- MAIN CONTENT -->
<div id="panel-home" class="tab-panel active">
<div class="container">

  <div class="content-grid">

    <!-- HERO -->
    <div class="hero-col">
      <div class="section-label">Top Story</div>
      <article class="hero-article">
        <span class="article-tag">City Hall</span>
        <h2><a href="article.html">Rochester City Council Votes on Controversial 2025 Budget â€” What It Means for You</a></h2>
        <div class="byline">By Staff Reporter Â· Feb 26, 2025 Â· 4 min read</div>
        <div class="hero-divider"></div>
        <p>After weeks of heated debate, the Rochester City Council cast their final votes late Tuesday evening on a $600 million budget proposal that will reshape public services across the Flower City. The plan includes cuts to the parks department, increased funding for community policing, and a controversial proposal to raise property taxes by 3.2% â€” a decision that has residents and local business owners deeply divided.</p>
        <p style="margin-top:0.8rem">Advocates for low-income neighborhoods argue the cuts disproportionately affect the city's most vulnerable residents, while the Mayor's office maintains the budget is a necessary step toward long-term fiscal stability.</p>
      </article>
    </div>

    <!-- SIDEBAR -->
    <div class="sidebar-col">
      <div class="section-label">Latest</div>
      <div class="sidebar-articles">
        <article class="sidebar-article">
          <div class="article-tag">Safety</div>
          <h3><a href="article.html">South Wedge Reports Spike in Car Break-Ins; RPD Increases Patrols</a></h3>
          <div class="byline">Feb 25, 2025 Â· 2 min read</div>
        </article>
        <article class="sidebar-article">
          <div class="article-tag">Infrastructure</div>
          <h3><a href="article.html">Route 104 Closure Extended Through March â€” Alternate Routes Listed</a></h3>
          <div class="byline">Feb 24, 2025 Â· 3 min read</div>
        </article>
        <article class="sidebar-article">
          <div class="article-tag">Community</div>
          <h3><a href="article.html">Highland Park Lilac Festival 2025 Announces Full Schedule</a></h3>
          <div class="byline">Feb 23, 2025 Â· 2 min read</div>
        </article>
        <article class="sidebar-article">
          <div class="article-tag">Schools</div>
          <h3><a href="article.html">RCSD Announces New After-School Programs Amid Funding Uncertainty</a></h3>
          <div class="byline">Feb 22, 2025 Â· 3 min read</div>
        </article>
      </div>
    </div>

  </div><!-- /content-grid -->

  <!-- SECONDARY ROW -->
  <div class="secondary-row">
    <article class="secondary-article">
      <div class="article-tag">Neighborhoods</div>
      <h3><a href="article.html">Corn Hill Residents Push Back Against Proposed Apartment Development</a></h3>
      <p>A 200-unit mixed-use development on the Genesee riverfront has drawn fierce opposition from longtime Corn Hill residents who say the project will change the neighborhood's historic character.</p>
      <div class="byline">Feb 21, 2025 Â· 4 min read</div>
    </article>
    <article class="secondary-article">
      <div class="article-tag">Health</div>
      <h3><a href="article.html">Strong Memorial Reports Staffing Shortage as Winter Illness Season Peaks</a></h3>
      <p>Hospital administrators warn of longer ER wait times and are urging residents to use urgent care centers for non-emergency situations throughout February and March.</p>
      <div class="byline">Feb 20, 2025 Â· 3 min read</div>
    </article>
    <article class="secondary-article">
      <div class="article-tag">Events</div>
      <h3><a href="article.html">ROC the Riverway Winter Market Returns to the Inner Loop This Weekend</a></h3>
      <p>The beloved outdoor winter market is back with over 60 local vendors, live music, and food trucks â€” a welcome respite amid the ongoing cold snap gripping the region.</p>
      <div class="byline">Feb 19, 2025 Â· 2 min read</div>
    </article>
  </div>

</div><!-- /container -->
</div><!-- /panel-home -->

<!-- TIPS TAB PANEL -->
<div id="panel-tips" class="tab-panel">
  <div class="tips-panel" style="max-width:900px;">
    <div class="tips-panel-header">
      <div class="page-label">Community Input</div>
      <h2>Tips & Contact</h2>
      <p>StateOfRochester runs on community knowledge. Submit a developing news tip or weigh in on where the Crisis Meter should be set. All submissions are read. Your identity is never published without permission.</p>
    </div>

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:3rem;">

      <!-- FORM 1: STORY TIP -->
      <div>
        <div style="display:flex;align-items:flex-start;gap:1rem;margin-bottom:1.4rem;padding-bottom:1.2rem;border-bottom:2px solid var(--ink);">
          <div style="font-size:1.8rem;line-height:1;margin-top:0.1rem;">ðŸ“°</div>
          <div>
            <h3 style="font-family:'Playfair Display',serif;font-size:1.3rem;font-weight:700;margin-bottom:0.3rem;">Submit a Story Tip</h3>
            <p style="font-size:0.82rem;color:#666;line-height:1.5;">Know about something happening in Rochester that deserves coverage? Tell us about it.</p>
          </div>
        </div>
        <form id="home-tip-form" action="https://formspree.io/f/mwvnyddg" method="POST">
          <input type="hidden" name="_subject" value="StateOfRochester â€” New Story Tip" />
          <div class="tip-field" style="margin-bottom:1.1rem;">
            <label>Your Name <span style="color:#bbb">(optional)</span></label>
            <input type="text" name="name" placeholder="Anonymous is fine" />
          </div>
          <div class="tip-field" style="margin-bottom:1.1rem;">
            <label>Your Email <span style="color:#bbb">(optional)</span></label>
            <input type="email" name="email" placeholder="Never published" />
          </div>
          <div class="tip-field" style="margin-bottom:1.1rem;">
            <label>Category</label>
            <select name="category">
              <option value="" disabled selected>Select a category</option>
              <option>Public Safety</option>
              <option>City Hall / Politics</option>
              <option>Infrastructure</option>
              <option>Schools</option>
              <option>Neighborhoods</option>
              <option>Health</option>
              <option>Events</option>
              <option>Other</option>
            </select>
          </div>
          <div class="tip-field" style="margin-bottom:1.1rem;">
            <label>What's the tip? *</label>
            <textarea name="tip" placeholder="Describe what you've seen, heard, or know. Include location, names, and any relevant details." required></textarea>
          </div>
          <div class="tip-field" style="margin-bottom:1.1rem;">
            <label>How did you hear about this? <span style="color:#bbb">(optional)</span></label>
            <input type="text" name="source" placeholder="e.g. firsthand, scanner, local group..." />
          </div>
          <button type="submit" class="tip-submit" style="background:var(--red);">Send Story Tip â†’</button>
          <p class="tip-privacy">Your contact info is used only to follow up on your tip and will never be published or shared.</p>
        </form>
      </div>

      <!-- FORM 2: METER FEEDBACK -->
      <div>
        <div style="display:flex;align-items:flex-start;gap:1rem;margin-bottom:1.4rem;padding-bottom:1.2rem;border-bottom:2px solid var(--ink);">
          <div style="font-size:1.8rem;line-height:1;margin-top:0.1rem;">ðŸ“Š</div>
          <div>
            <h3 style="font-family:'Playfair Display',serif;font-size:1.3rem;font-weight:700;margin-bottom:0.3rem;">Crisis Meter Feedback</h3>
            <p style="font-size:0.82rem;color:#666;line-height:1.5;">Think the meter is too high or too low? Tell us what you're seeing on the ground.</p>
          </div>
        </div>
        <form id="home-meter-form" action="https://formspree.io/f/xbdawvnj" method="POST">
          <input type="hidden" name="_subject" value="StateOfRochester â€” Crisis Meter Feedback" />
          <div class="tip-field" style="margin-bottom:1.1rem;">
            <label>Your Name <span style="color:#bbb">(optional)</span></label>
            <input type="text" name="name" placeholder="Anonymous is fine" />
          </div>
          <div class="tip-field" style="margin-bottom:1.1rem;">
            <label>Your Neighborhood <span style="color:#bbb">(optional)</span></label>
            <input type="text" name="neighborhood" placeholder="e.g. South Wedge, Corn Hill, East Ave..." />
          </div>
          <div class="tip-field" style="margin-bottom:1.1rem;">
            <label>Where do you think the meter should be?</label>
            <div style="margin-top:0.4rem;">
              <div style="width:100%;height:12px;border-radius:2px;background:linear-gradient(to right,#c0392b 0%,#e67e22 25%,#f1c40f 50%,#a8d840 75%,#27ae60 100%);margin-bottom:0.5rem;"></div>
              <input type="range" id="home-meter-slider" name="suggested_level" min="0" max="100" value="50"
                style="width:100%;appearance:none;-webkit-appearance:none;height:4px;background:#bbb;border:none;padding:0;cursor:pointer;border-bottom:none;"
                oninput="document.getElementById('home-slider-display').textContent = getSliderLabel(this.value) + ' (' + this.value + ')'; updateThumbColor(this);" />
              <div style="display:flex;justify-content:space-between;font-family:'DM Mono',monospace;font-size:0.52rem;letter-spacing:0.08em;color:var(--mid);text-transform:uppercase;margin-top:0.4rem;">
                <span>ðŸ”´ Critical</span><span>High</span><span>Moderate</span><span>Stable</span><span>All Clear ðŸŸ¢</span>
              </div>
              <div id="home-slider-display" style="text-align:center;font-family:'DM Mono',monospace;font-size:0.7rem;font-weight:500;color:var(--ink);margin-top:0.5rem;letter-spacing:0.1em;">Moderate (50)</div>
            </div>
          </div>
          <div class="tip-field" style="margin-bottom:1.1rem;">
            <label>Why do you feel this way? *</label>
            <textarea name="reason" placeholder="What are you observing in your neighborhood or around the city?" required style="min-height:100px;"></textarea>
          </div>
          <div class="tip-field" style="margin-bottom:1.1rem;">
            <label>Your Email <span style="color:#bbb">(optional)</span></label>
            <input type="email" name="email" placeholder="In case we have questions" />
          </div>
          <button type="submit" class="tip-submit">Send Meter Feedback â†’</button>
          <p class="tip-privacy">Your contact info is never published or shared. All meter updates are made at editorial discretion.</p>
        </form>
      </div>

    </div><!-- /two-col grid -->
  </div>
</div><!-- /panel-tips -->

<!-- FOOTER -->
<footer>
  <div class="footer-title">StateOfRochester</div>
  <p>Independent community journalism for Rochester, NY Â· <a href="#tips" onclick="showTab('tips', document.getElementById('tips-tab')); return false;">Submit a Tip</a> Â· <a href="about.html">About</a> Â· <a href="about.html">Contact</a></p>
  <p style="margin-top:0.5rem">Â© 2025 StateOfRochester. All rights reserved.</p>
</footer>

<script src="js/data.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
  // Load crisis meter data from CMS
  async function loadCrisisMeter() {
    const data = await window.StateOfRochester.fetchCrisisMeter();
    
    document.getElementById('meter-marker').style.left = data.level + '%';
    document.getElementById('crisis-label').textContent = data.label;
    document.getElementById('crisis-desc').textContent = data.description;
    
    if (data.updated_note) {
      document.getElementById('crisis-updated').textContent = data.updated_note;
    }
    
    // Also update sidebar meter if present
    const sidebarMarker = document.getElementById('sidebar-meter-marker');
    if (sidebarMarker) {
      sidebarMarker.style.left = data.level + '%';
    }
    const sidebarLabel = document.getElementById('sidebar-meter-label');
    if (sidebarLabel) {
      sidebarLabel.textContent = data.label;
    }
    const sidebarDesc = document.getElementById('sidebar-meter-desc');
    if (sidebarDesc) {
      sidebarDesc.textContent = data.description;
    }
  }

  // Load articles from CMS
  async function loadArticles() {
    try {
      const response = await fetch('_data/articles.json');
      const data = await response.json();
      const articles = data.articles || [];
      
      // Find featured article (hero)
      const featured = articles.find(a => a.featured) || articles[0];
      
      // Get other articles for sidebar and secondary
      const otherArticles = articles.filter(a => a !== featured);
      
      // Render hero article
      if (featured) {
        const heroContainer = document.querySelector('.hero-article');
        if (heroContainer) {
          heroContainer.innerHTML = `
            <span class="article-tag">${window.StateOfRochester.getCategoryDisplay(featured.category)}</span>
            <h2><a href="article.html?slug=${featured.slug}">${featured.title}</a></h2>
            <div class="byline">By ${featured.author} Â· ${featured.date} Â· ${featured.read_time}</div>
            <div class="hero-divider"></div>
            <p>${featured.dek || 'Click to read the full story.'}</p>
          `;
        }
      }
      
      // Render sidebar articles
      const sidebarContainer = document.querySelector('.sidebar-articles');
      if (sidebarContainer && otherArticles.length > 0) {
        let sidebarHTML = '';
        otherArticles.slice(0, 4).forEach(article => {
          sidebarHTML += `
            <article class="sidebar-article">
              <div class="article-tag">${window.StateOfRochester.getCategoryDisplay(article.category)}</div>
              <h3><a href="article.html?slug=${article.slug}">${article.title}</a></h3>
              <div class="byline">${article.date} Â· ${article.read_time}</div>
            </article>
          `;
        });
        sidebarContainer.innerHTML = sidebarHTML;
      }
      
      // Render secondary articles
      const secondaryContainer = document.querySelector('.secondary-row');
      if (secondaryContainer && otherArticles.length > 4) {
        let secondaryHTML = '';
        otherArticles.slice(4, 7).forEach(article => {
          secondaryHTML += `
            <article class="secondary-article">
              <div class="article-tag">${window.StateOfRochester.getCategoryDisplay(article.category)}</div>
              <h3><a href="article.html?slug=${article.slug}">${article.title}</a></h3>
              <p>${article.dek || 'Click to read more.'}</p>
              <div class="byline">${article.date} Â· ${article.read_time}</div>
            </article>
          `;
        });
        // Replace content between the div tags
        secondaryContainer.innerHTML = secondaryHTML;
      }
    } catch (error) {
      console.error('Error loading articles:', error);
    }
  }

  // AJAX form submission â€” bypasses Formspree's default thank-you page
  // and redirects to our own thankyou.html instead
  function handleFormSubmit(formId) {
    const form = document.getElementById(formId);
    if (!form) return;
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      const btn = form.querySelector('button[type="submit"]');
      const originalText = btn.textContent;
      btn.textContent = 'Sendingâ€¦';
      btn.disabled = true;
      try {
        const response = await fetch(form.action, {
          method: 'POST',
          body: new FormData(form),
          headers: { 'Accept': 'application/json' }
        });
        if (response.ok) {
          window.location.href = 'https://crisis-meter.vercel.app/thankyou.html';
        } else {
          btn.textContent = 'Error â€” please try again';
          btn.disabled = false;
        }
      } catch (err) {
        btn.textContent = 'Error â€” please try again';
        btn.disabled = false;
      }
    });
  }
  handleFormSubmit('home-tip-form');
  handleFormSubmit('home-meter-form');

  // Gradient color interpolation for slider thumb
  const gradientStops = [
    { pct: 0,   r: 192, g: 57,  b: 43  },  // #c0392b
    { pct: 25,  r: 230, g: 126, b: 34  },  // #e67e22
    { pct: 50,  r: 241, g: 196, b: 15  },  // #f1c40f
    { pct: 75,  r: 168, g: 216, b: 64  },  // #a8d840
    { pct: 100, r: 39,  g: 174, b: 96  },  // #27ae60
  ];
  function interpolateGradientColor(pct) {
    let lower = gradientStops[0], upper = gradientStops[gradientStops.length - 1];
    for (let i = 0; i < gradientStops.length - 1; i++) {
      if (pct >= gradientStops[i].pct && pct <= gradientStops[i + 1].pct) {
        lower = gradientStops[i];
        upper = gradientStops[i + 1];
        break;
      }
    }
    const range = upper.pct - lower.pct;
    const t = range === 0 ? 0 : (pct - lower.pct) / range;
    const r = Math.round(lower.r + t * (upper.r - lower.r));
    const g = Math.round(lower.g + t * (upper.g - lower.g));
    const b = Math.round(lower.b + t * (upper.b - lower.b));
    return `rgb(${r},${g},${b})`;
  }
  // Dynamic style tag for thumb color
  const thumbStyle = document.createElement('style');
  thumbStyle.id = 'thumb-color-style';
  document.head.appendChild(thumbStyle);
  function updateThumbColor(input) {
    const color = interpolateGradientColor(parseInt(input.value));
    const id = input.id;
    thumbStyle.textContent = `
      #${id}::-webkit-slider-thumb { background: ${color} !important; box-shadow: 0 0 0 2px ${color}, 0 0 6px ${color}88; }
      #${id}::-moz-range-thumb    { background: ${color} !important; box-shadow: 0 0 0 2px ${color}, 0 0 6px ${color}88; }
    `;
  }
  // Init thumb color on page load AND when tips tab is opened
  function initSliderColor() {
    const s = document.getElementById('home-meter-slider');
    if (s) updateThumbColor(s);
  }
  window.addEventListener('load', initSliderColor);

  // Slider label helper (used by tips tab meter slider)
  function getSliderLabel(val) {
    const v = parseInt(val);
    if      (v < 17) return 'Critical';
    else if (v < 33) return 'High Concern';
    else if (v < 50) return 'Elevated';
    else if (v < 67) return 'Moderate';
    else if (v < 83) return 'Stable';
    else             return 'All Clear';
  }

  // Tab switching
  function showTab(tabName, clickedLink) {
    document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
    document.getElementById('panel-' + tabName).classList.add('active');
    clickedLink.classList.add('active');
    window.scrollTo({ top: document.querySelector('nav').offsetTop - 10, behavior: 'smooth' });
    // Init slider color when tips tab becomes visible
    if (tabName === 'tips') setTimeout(initSliderColor, 50);
  }

  // Allow tips.html links to open the tips tab when coming from other pages
  if (window.location.hash === '#tips') {
    showTab('tips', document.getElementById('tips-tab'));
  }

  // Set today's date in masthead
  const d = new Date();
  document.getElementById('todays-date').textContent = d.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

  // Set crisis meter "last updated" timestamp (will be overridden by CMS data)
  document.getElementById('crisis-updated').textContent = 'Updated ' + d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) + ' at ' + d.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });

  // Load dynamic content from CMS
  loadCrisisMeter();
  loadArticles();
</script>

</body>
</html>
